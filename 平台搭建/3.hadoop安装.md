## hadoop 集群部署

* 版本
```
2.9.0
```
* 下载解压
```
tar -xvf hadoop-2.9.0.tar.gz
```

* 配置各种home
```
HADOOP_HOME
YARN_CONF_DIR
HADOOP_CONF_DIR
```

* 配置hadoop-env.sh

```
export JAVA_HOME=${JAVA_HOME}
export HADOOP_HEAPSIZE=2000
export HADOOP_NAMENODE_INIT_HEAPSIZE=2000
export HADOOP_LOG_DIR=xxx
```

*配置hdfs-site.xml
```
<property>
    <name>dfs.data.dir</name>
    <value>xxx, xxx</value>
</property>

<property>
    <name>dfs.name.dir</name>
    <value>xxx</value>
</property>

<property>
        <name>dfs.replication</name>
        <value>2</value>
</property>
<property>
        <name>dfs.permissions</name>
        <value>false</value>
</property>
```

* 配置core-site.xml
```
<configuration>
    <property>
        <name>fs.defaultFS</name>
        <value>hdfs://xxx:9000</value>
    </property>

    <property>
        <name>fs.trash.interval</name>
        <value>1440</value>
    </property>
</configuration>
```

* 配置mapred-site.xml
```
<property>
  <name>mapreduce.framework.name</name>
  <value>yarn</value>
</property>
```

* 配置yarn-site.xml
```
  <property>
    <name>yarn.resourcemanager.hostname</name>
    <value>xxx</value>
  </property>

  <property>
    <name>yarn.nodemanager.aux-services</name>
    <value>mapreduce_shuffle</value>
  </property>

  <property>
    <name>yarn.log-aggregation-enable</name>
    <value>true</value>
  </property>

  <property>
    <name>yarn.nodemanager.remote-app-log-dir</name>
    <value>hdfs://xx:9000/user/hpe/yarn-logs/</value>
  </property>

  <property>
    <name>yarn.log-aggregation.retain-seconds</name>
    <value>2592000</value>
  </property>

  <property>
    <name>yarn.log.server.url</name>
    <value>http://xx:19888/jobhistory/logs</value>
  </property>

  <property>
          <name>yarn.nodemanager.resource.memory-mb</name>
          <value>4096</value> <!-- 4G -->
  </property>
  <property>
          <name>yarn.scheduler.minimum-allocation-mb</name>
          <value>2048</value>
  </property>
  <property>
          <name>yarn.scheduler.maximum-allocation-mb</name>
          <value>2048</value>
  </property>
  <property>
          <name>yarn.app.mapreduce.am.resource.mb</name>
          <value>2048</value>
  </property>
  <property>
          <name>yarn.nodemanager.resource.cpu-vcores</name>
          <value>4</value>
  </property>

  <property>
          <name>yarn.scheduler.maximum-allocation-vcores</name>
          <value>16</value>
  </property>
```
